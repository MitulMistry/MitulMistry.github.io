<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Mitul Mistry, Full-Stack Developer &#8211; Mitul Mistry - Tech Blog</title>
<meta name="description" content="The technical blog of Mitul Mistry.">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@mmystic">
<meta name="twitter:creator" content="@mmystic">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Mitul Mistry, Full-Stack Developer">
<meta property="og:description" content="The technical blog of Mitul Mistry.">
<meta property="og:url" content="/">
<meta property="og:site_name" content="Mitul Mistry - Tech Blog">
<meta property="og:image" content="/images/images/logo_mm2.png">





<link rel="canonical" href="/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Mitul Mistry - Tech Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">




</head>

<body id="post-index">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="/">
          
            <img class="logo" src="/images/logo_mm2.png" alt="Mitul Mistry - Tech Blog">
          
          <a href="/" class="title"> Mitul Mistry - Tech Blog</a>
        </a>
      </li>
      
        
        

        
          <li class="header-item "><a href="/categories"><h3>Categories</h3></a>
            <ul class="header-submenu">
              
                
                  <li class="sub-item"><a href="/categories/#angular">angular</a></li>
              
                
                  <li class="sub-item"><a href="/categories/#general">general</a></li>
              
                
                  <li class="sub-item"><a href="/categories/#javascript">javascript</a></li>
              
                
                  <li class="sub-item"><a href="/categories/#rails">rails</a></li>
              
                
                  <li class="sub-item"><a href="/categories/#ruby">ruby</a></li>
              
                
                  <li class="sub-item"><a href="/categories/#sinatra">sinatra</a></li>
              
            </ul>
          </li>
        
      
        
        

        
            
                <li class="header-item "><a href="/about"><h3>About</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="/"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Mitul Mistry, Full-Stack Developer</h1>
      
        <h2><span class="entry-date"><time>&nbsp;</time></span></h2>
      

      
          <p class="entry-reading-time">
            &nbsp;
          </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="/"><h3>Home</h3></a></li>
      
    
      
        <li><a href="/about"><h3>About</h3></a></li>
      
    
      
        <li><a href="/categories"><h3>Categories</h3></a>
          <ul>
            
              
                <li><a href="/categories/#angular">angular</a></li>
            
              
                <li><a href="/categories/#general">general</a></li>
            
              
                <li><a href="/categories/#javascript">javascript</a></li>
            
              
                <li><a href="/categories/#rails">rails</a></li>
            
              
                <li><a href="/categories/#ruby">ruby</a></li>
            
              
                <li><a href="/categories/#sinatra">sinatra</a></li>
            
          </ul>
        </li>
      
    
  </ul>
</nav>


  <a href="https://twitter.com/mmystic" class="btn btn-info button-twitter" data-show-count="false" data-size="large"><i class="fa fa-twitter"></i> <span> | Follow @mmystic</span></a>



<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-06-02T11:00:00-05:00"><a href="/ruby/rails/building-apis/">June 02, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Mitul Mistry">Mitul Mistry</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/ruby/rails/building-apis/" rel="bookmark" title="Building APIs" itemprop="url">Building APIs</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>There’s a lot of data out there on the Internet. We can access the data that other providers make available by consuming their <code>APIs</code>. An <code>API</code> - or application protocol interface - is a way to serve and access data. Accessing data from other sources allows you to use their data to build on their services, provide additional functionality, and use their data in new and inventive ways. This is an external <code>API</code>.</p>

<p>However, internal <code>APIs</code> are just as common. This makes data more accessible to our own application and associated services, something that’s especially useful when using <code>AJAX</code> and <code>JavaScript</code> frameworks. Building an <code>API</code> in Rails is often a straightforward process, especially when the model is simple, since Rails has tools to make the data available in different formats.</p>

<p><strong>JSON</strong></p>

<p>Data available through <code>APIs</code>, internal or external, often comes in the form of <a href="https://en.wikipedia.org/wiki/JSON">JSON</a>, or JavaScript Object Notation. It’s a standard format used for efficient readability - both for developers and parsers. To create an <code>API</code> in Rails, all we have to do is take the data from a model and serialize it - or turn it into <code>JSON</code> data. We can do that using the <code>.to_json</code> method.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># posts_controller.rb</span>
<span class="c1"># ...</span>
 <span class="k">def</span> <span class="nf">post_data</span>
   <span class="n">post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
   <span class="n">render</span> <span class="ss">json: </span><span class="n">post</span><span class="p">.</span><span class="nf">to_json</span>
 <span class="k">end</span></code></pre></figure>

<p>Here, Rails takes the post and converts it to <code>JSON</code> to be served. We can serve different formats using <code>respond_to</code>. We can also limit the data we’re serving and include associations as well.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># posts_controller</span>
<span class="c1"># ...</span>
 <span class="k">def</span> <span class="nf">show</span>
   <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
   <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
     <span class="nb">format</span><span class="p">.</span><span class="nf">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:show</span> <span class="p">}</span>
     <span class="nb">format</span><span class="p">.</span><span class="nf">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json: </span><span class="vi">@post</span><span class="p">.</span><span class="nf">to_json</span><span class="p">(</span><span class="ss">only: </span><span class="p">[</span><span class="ss">:title</span><span class="p">,</span> <span class="ss">:description</span><span class="p">,</span> <span class="ss">:id</span><span class="p">],</span>
                             <span class="ss">include: </span><span class="p">[</span><span class="ss">author: </span><span class="p">{</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:name</span><span class="p">]}])</span> <span class="p">}</span>
   <span class="k">end</span>
 <span class="k">end</span></code></pre></figure>

<p>However, as things get more complicated, we might want to find a cleaner way. We can instead use <a href="https://github.com/rails-api/active_model_serializers">ActiveModel Serializers</a>. You include and install the gem, run <code>rails g serializer &lt;model name&gt;</code>, and modify the attributes in the new serializer class file. Then, when we respond with <code>JSON</code> data, it serializes the model implicitly.</p>

<p>So now you can just do:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># posts_controller.rb</span>
<span class="c1"># ...</span>
<span class="k">def</span> <span class="nf">show</span>
   <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
   <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
     <span class="nb">format</span><span class="p">.</span><span class="nf">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:show</span> <span class="p">}</span>
     <span class="nb">format</span><span class="p">.</span><span class="nf">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json: </span><span class="vi">@post</span><span class="p">}</span>
   <span class="k">end</span>
 <span class="k">end</span>
 </code></pre></figure>

<p>Now when you build a JavaScript front end that wants to make dynamic <code>AJAX</code> requests without reloading, you can do that by accessing these serializer-enabled controller actions.</p>

<p>You can read more about Rails ActiveModel Serializers in the <a href="http://guides.rubyonrails.org/active_model_basics.html#serialization">Rails Guides</a>.</p>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-06-02T09:30:00-05:00"><a href="/javascript/angular/intro-to-angular/">June 02, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Mitul Mistry">Mitul Mistry</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/javascript/angular/intro-to-angular/" rel="bookmark" title="Intro to Angular" itemprop="url">Intro to Angular</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>Using a combination of Rails templates and <code>jQuery</code>, we can create a decent interactive front end for our applications. But this process can quickly become ugly and limited, devolving into a mess of <code>ERB</code> tags and <code>JavaScript</code> functions. This is one of the reasons for the evolution of front end frameworks, one of them being the Google backed <a href="https://angularjs.org/">Angular JS</a>.</p>

<p>Angular exists to help developers build single-page applications. It provides structure and tools to help solve common problems without having to reinvent the wheel with every application.</p>

<p>Without <code>JavaScript</code> and JS frameworks, everything is rendered on the server. For example, through the <code>MVC</code> paradigm of Rails, the controller renders a view and sends it back as a response. But if you want to make make small changes and see different results - such as adjusting the price range while shopping for a product - you would have to initiate a page reload with every request.</p>

<p>With Angular, not only does it handle routing so you can load different pages without a page reload, it allows you to build dynamic views that react to your input spontaneously.</p>

<p><strong>MVVM</strong></p>

<p>While Rails utilizes the <code>MVC</code> paradigm - model, view controller - Angular utilizes <code>MVVM</code> - model, view, viewmodel. The controller is replaced with the viewmodel, which is responsible for all view logic.</p>

<p><strong>Data Binding</strong></p>

<p>In order to create views that are dynamic and respond to user input, the concept of data binding is employed. This means that data from one source - such as an input field - is bound to something else - like a text box - so it displays your text spontaneously, something that couldn’t really be done in Rails without <code>JavaScript</code>.</p>

<p>In addition, two way data binding is used to keep data from a view synchronized with the data in a model. You can read more about data binding <a href="https://docs.angularjs.org/guide/databinding">here on the Angular docs</a>.</p>

<p>Angular is an extensive framework with a lot of moving parts. You can delve deeper by taking a look at the <a href="https://docs.angularjs.org/guide/introduction">Angular documentation</a>.</p>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-06-02T07:15:00-05:00"><a href="/ruby/rails/rails-sessions/">June 02, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Mitul Mistry">Mitul Mistry</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/ruby/rails/rails-sessions/" rel="bookmark" title="Rails Sessions" itemprop="url">Rails Sessions</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>When building a web application, usually we want some capacity for a user to create an account, login, and then interact with the site in a way that’s tied to their identity. If you login to Amazon, it loads up your cart with the items you selected earlier. If you login to Facebook, it loads your profile and your friends. This is something we take for granted - it’s something that’s always there and just “works.”</p>

<p>But HTTP is stateless. Meaning, you send a request to the server, it sends you a response, and that interaction is done. The server doesn’t remember you solely based on the request. So how can we get the server to remember us so we don’t have to login with every request we send?</p>

<p><strong>Cookies</strong></p>

<p>A cookie is just a string that’s stored on your computer with information identifying you and your interaction with a specific site. When you make a request to the server, data is drawn from the cookie and put into the request header when it’s sent. This information gives the server a way to know that the request is coming from you.</p>

<p>In Rails, you can use cookies via <code>sessions</code>. A <code>session</code> is a hash that you can use to store data for a particular interaction with a user. Rails serializes the data in this hash and turns it into a cookie.</p>

<p>Here’s an example:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># set user_id</span>
<span class="n">session</span><span class="p">[</span><span class="ss">:user_id</span><span class="p">]</span> <span class="o">=</span> <span class="vi">@user</span><span class="p">.</span><span class="nf">id</span>

<span class="c1"># load the user referenced in the session</span>
<span class="vi">@user</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="ss">:user_id</span><span class="p">]</span></code></pre></figure>

<p>Since the cookie is just a string, a user could theoretically manipulate the string before sending it back. To prevent this, Rails cryptographically signs the cookie to ensure it’s authentic and untampered with.</p>

<p><strong>Authentication</strong></p>

<p>So how would we make sure the user is logged in before serving any data? This could be a simple implementation using <code>session</code>:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">class</span> <span class="nc">DocumentsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">before_action</span> <span class="ss">:require_login</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@document</span> <span class="o">=</span> <span class="no">Document</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">index</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create</span>
    <span class="vi">@document</span> <span class="o">=</span> <span class="no">Document</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">author_id: </span><span class="n">user_id</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">require_login</span>
    <span class="k">return</span> <span class="n">head</span><span class="p">(</span><span class="ss">:forbidden</span><span class="p">)</span> <span class="k">unless</span> <span class="n">session</span><span class="p">.</span><span class="nf">include?</span> <span class="ss">:user_id</span>   
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>Authentication is usually a complex process involving securely storing passwords, checking if the user entered the correct password, and it also entails dealing with new user registration and destroying your session by logging out. For me, I prefer not having to rewrite this boilerplate functionality for every project, so usually I just use the <a href="https://github.com/plataformatec/devise">Devise gem</a>.</p>

<p>Once set up, it handles all of these issues and it’s quite heavily used and tested so you can rest assured that it’s secure. Once you understand the basics of how sessions and authentication work, we can outsource this functionality to a gem like Devise.</p>

<p>You can read more about sessions in the <a href="http://guides.rubyonrails.org/security.html">Rails Guides</a>.</p>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-06-01T11:45:00-05:00"><a href="/javascript/rails/jquery-rails-app/">June 01, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Mitul Mistry">Mitul Mistry</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~4 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/javascript/rails/jquery-rails-app/" rel="bookmark" title="jQuery Rails App" itemprop="url">jQuery Rails App</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>With <code>Rails</code>, I’ve been working a lot on dealing with the back end through <code>ActiveRecord</code> and using Rails templates with <a href="http://mitulmistry.github.io/ruby/rails/rails-forms/">form helpers</a>. However, modern web applications focus on spontaneous interaction, meaning single page apps with no page reloads. There are a variety of front end frameworks - like <a href="https://angularjs.org/">Angular</a>, which I will be working with later - that many of the websites we use every day are built with. However, it’s possible to create interactive applications solely with <a href="https://jquery.com/">jQuery</a> - a <code>JavaScript</code> library that most websites leverage in one way or another.</p>

<p>For this project, I wanted to create a simple note taking application kind of like Google Keep where the user can create and display notes without reloading the page. This creates a smoother, more natural user experience that I achieved with a <code>jQuery</code> front end.</p>

<p><strong>Rails Back End</strong></p>

<p>Before focusing on user interaction, I organized the back end using <code>Rails</code> controllers and models. I used <a href="https://github.com/plataformatec/devise">Devise</a> to set up a user model and authentication since notes wouldn’t be public - they needed to be limited to an individual user. After that, I used <code>rails generate resource</code> to generate the files for notes and tags. The controllers are set up similarly to those in my <a href="http://mitulmistry.github.io/ruby/rails/rails-project/">last Rails project</a>, with the exception of needing to account for the <code>AJAX</code> requests that would be coming from the <code>jQuery</code> front end.</p>

<p><code>AJAX</code> stands for Asynchronous JavaScript and XML, but most of the time it’s used with <code>JavaScript</code> as XML has become deprecated in favor of <code>JSON</code> - <a href="https://en.wikipedia.org/wiki/JSON">JavaScript Object Notation</a>.</p>

<p>Here is an example of an action in the notes controller handling both <code>HTML</code> and <code>JSON</code> requests:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@note</span> <span class="o">=</span> <span class="no">Note</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
   <span class="nb">format</span><span class="p">.</span><span class="nf">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:show</span> <span class="p">}</span>
   <span class="nb">format</span><span class="p">.</span><span class="nf">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json: </span><span class="vi">@note</span> <span class="p">}</span>
 <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>With <code>respond_to</code>, we’re able to handle requests for different formats. If we have a link that makes an <code>HTML</code> request for a note, we render the note template. However, if we get a request for <code>JSON</code>, we render the note in serialized <code>JSON</code> format.</p>

<p>What is serialization and how does <code>Rails</code> do it? There are a variety of ways, but I used <a href="https://github.com/rails-api/active_model_serializers">ActiveModel Serializers</a> which implicitly turns <code>@note</code> into <code>JSON</code> data.</p>

<p>You can take a look at my controllers <a href="https://github.com/MitulMistry/post-it/tree/master/app/controllers">here</a>. Once the back end is set up, we can move on.</p>

<p><strong>jQuery Front End</strong></p>

<p>There’s a lot of code that went into seemingly basic functionality such as creating new notes, displaying notes based on a tag, and pagination without reloading. I’ll go over some of it briefly.</p>

<p>This portion of code attaches an event listener to the new tag form and processes the request to create a new form:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">attachListeners</span><span class="p">(){</span>
  <span class="c1">//create new tag</span>
  <span class="nx">$</span><span class="p">(</span><span class="s1">'form#new_tag'</span><span class="p">).</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span> <span class="c1">//prevent form from submitting the default way and reloading page</span>

    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#tag_name'</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">validator</span><span class="p">.</span><span class="nx">validateTag</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">serialize</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">posting</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/tags'</span><span class="p">,</span> <span class="nx">values</span><span class="p">);</span>

      <span class="nx">posting</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">'form #tag_name'</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="s1">''</span><span class="p">);</span> <span class="c1">//clear form input</span>
        <span class="nx">loadTags</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>

<span class="p">.........</span>
<span class="p">}</span></code></pre></figure>

<p><code>event.preventDefault()</code> is necessary in order to prevent the default behavior of the form, which is to submit and reload the page. Anything with a <code>$</code> is shorthand for <code>jQuery</code>, so it’s invoking a <code>jQuery</code> object or function. <code>var name = $('#tag_name').val()</code> gets the tag name value from the text input of the form and sets it to a variable. It validates it client side with a custom Validator class and if the data passes, it processes the request.</p>

<p><code>var values = $(this).serialize()</code> serializes the data in the form via <code>jQuery</code> and prepares it to be sent. <code>var posting = $.post('/tags', values)</code> makes a <code>jQuery</code> POST request to the tags controller with the data from the form that has been serialized. Once the posting is finished, we set a <code>.done</code> callback to clear the form input field and then call the <code>loadTags()</code> function.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">loadTags</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s1">'/tags'</span><span class="p">).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">tags</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>

    <span class="nx">$</span><span class="p">(</span><span class="s1">'div#tags'</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">''</span><span class="p">);</span> <span class="c1">//clear tags</span>

    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tags</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">'div#tags'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">generateTagLink</span><span class="p">(</span><span class="nx">tags</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
    <span class="p">}</span>

    <span class="nx">addTagListeners</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">}</span></code></pre></figure>

<p>Here, we make a <code>jQuery</code> <code>.getJSON</code> request to ask for <code>JSON</code> data from our tags controller. Since we set it up with a <code>respond_to</code> earlier, the controller uses <code>ActiveModel Serializers</code> to send the tag model as serialized <code>JSON</code> data to <code>jQuery</code>. Yes, this is a lot of serialization back and forth, but it’s necessary if we want two way <code>AJAX</code> communication between our front and back ends.</p>

<p>We get our tags as <code>JSON</code> data and iterate through it to generate the <code>HTML</code> necessary to display each tag. From there, we call the <code>addTagListeners()</code> function to add click events to each tag, so when we click on a tag it will then make another <code>AJAX</code> request to get all the notes associated with the clicked tag.</p>

<p>There’s a lot more to it, but this gives a good sense of the basics of the project. You can take a look at the <code>JavaScript</code> portion of the project <a href="https://github.com/MitulMistry/post-it/tree/master/app/assets/javascripts">here</a> and explore some of the additional functionality yourself.</p>

<p>You can see the source code for the whole project <a href="https://github.com/MitulMistry/post-it">here on Github</a>.</p>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-06-01T07:15:00-05:00"><a href="/ruby/rails/rails-forms/">June 01, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Mitul Mistry">Mitul Mistry</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/ruby/rails/rails-forms/" rel="bookmark" title="Rails Forms" itemprop="url">Rails Forms</a></h1>
    
  </header>
  <div class="entry-content">
    
      <p>To me, forms in web applications feel antiquated. There are better ways to get data from a user, such as getting access to a user’s other accounts (like Twitter or Facebook) via <a href="https://github.com/intridea/omniauth">OAuth</a> and populating data from there, but that’s not always an option. For now, we still have to input data manually and that means we need to use forms.</p>

<p>Forms are obnoxious. You have to pick out which input types are best for your scenario (text, radio buttons, dropdown lists, etc.). You need to style it with <code>CSS</code> so it looks presentable You need to define a route for the form to submit data to the back end. You have to deal with data validations and handle scenarios where users input unacceptable data. And  you have to deal with a host of other miscellaneous issues that come with such complex interaction.</p>

<p>Here’s a sample <code>HTML</code> form:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"users"</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;fieldset&gt;</span>
    First name:<span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"firstname"</span><span class="nt">&gt;&lt;br&gt;</span>
    Last name:<span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"lastname"</span><span class="nt">&gt;&lt;br&gt;&lt;br&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/fieldset&gt;</span>
<span class="nt">&lt;/form&gt;</span></code></pre></figure>

<p>Fortunately, <code>Rails</code> can help you generate forms using a few different tools which we’ll look at here.</p>

<p><strong>form_tag</strong></p>

<p><code>form_tag</code> is a Rails form helper used to help you build a basic form.</p>

<p>Here’s a sample <code>form_tag</code> form:</p>

<figure class="highlight"><pre><code class="language-erb" data-lang="erb"><span class="cp">&lt;%=</span> <span class="n">form_tag</span><span class="p">(</span><span class="s2">"/users"</span><span class="p">)</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  Name: <span class="cp">&lt;%=</span> <span class="n">text_field_tag</span> <span class="s2">"name"</span> <span class="cp">%&gt;</span><span class="nt">&lt;br&gt;</span>
  Email: <span class="cp">&lt;%=</span> <span class="n">text_field_tag</span> <span class="s2">"email"</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">submit_tag</span> <span class="s2">"Create User"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span></code></pre></figure>

<p>The actual <code>HTML</code> that’s produced will look like this:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/users"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"utf8"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"&amp;#x2713;"</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"TKTzvQF+atT/XHG/7h48xKVdXvILdiPj83XQhn2mWBNNhvv0Oh5YfAl2LM3DlHsQjbMOFVsYEyOwj+rPaSk3Bw=="</span> <span class="nt">/&gt;</span>
 Name: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">id=</span><span class="s">"name"</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
 Email: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">id=</span><span class="s">"email"</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">value=</span><span class="s">"Create User"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span></code></pre></figure>

<p>Just with a few simple lines of <code>ERB</code>, we’re able to create a fully realized form. It has an action and method already defined, as well as an authenticity token which is used to help prevent <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">cross-site request forgeries</a>.</p>

<p>However, <code>form_tag</code> is limited, specifically when it comes to dealing with forms directly related to back end <code>models</code>. If you want a different action method (such as wanting to reuse the same form for creating and editing a model), you have to specify it manually. It also won’t populate the form with data that’s already there. That’s where <code>form_for</code> comes in.</p>

<p><strong>form_for</strong></p>

<p><code>form_for</code> is like <code>form_tag</code> in that it helps you generate a form with <code>ERB</code> tags in a view template. However, <code>form_for</code> directly connects with a <code>model</code> in your Rails application and makes it easy to allow the creation of new <code>model</code> instances in your database.</p>

<p>Here’s a sample form_for form:</p>

<figure class="highlight"><pre><code class="language-erb" data-lang="erb"><span class="cp">&lt;%=</span> <span class="n">form_for</span> <span class="vi">@post</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
 <span class="cp">&lt;%=</span> <span class="n">f</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:title</span> <span class="cp">%&gt;</span>
 <span class="cp">&lt;%=</span> <span class="n">f</span><span class="p">.</span><span class="nf">text_area</span> <span class="ss">:content</span> <span class="cp">%&gt;</span>
 <span class="cp">&lt;%=</span> <span class="n">f</span><span class="p">.</span><span class="nf">submit</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span></code></pre></figure>

<p>This creates the following <code>HTML</code>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;form</span> <span class="na">class=</span><span class="s">"edit_post"</span> <span class="na">id=</span><span class="s">"edit_post"</span> <span class="na">action=</span><span class="s">"/posts/1"</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"utf8"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"&amp;#x2713;"</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"patch"</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">value=</span><span class="s">"nRPP2OqVKB00/Cr+8EvHfYrb5sAkZRtr8f6dzBaJAI+cMceR0fUatcLWd4zdwYCpojW2J3QLK6uyBKeFAgZvmw=="</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"post[title]"</span> <span class="na">id=</span><span class="s">"post_title"</span> <span class="na">value=</span><span class="s">"Existing Post Title"</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;textarea</span> <span class="na">name=</span><span class="s">"post[content]"</span> <span class="na">id=</span><span class="s">"post_content"</span><span class="nt">&gt;</span>Existing Post Content<span class="nt">&lt;/textarea&gt;</span>
 <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">value=</span><span class="s">"Update Post"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span></code></pre></figure>

<p>This is something that we can reuse for a create and an edit form, and it will populate data in the form automatically if there’s data there. The thing to remember here is that <code>form_for</code> needs an instance of the model to use which has to be provided from the <code>controller</code>. So for example:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">new</span>
  <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">new</span>
<span class="k">end</span></code></pre></figure>

<p>Of course now we need to wire these forms up with <code>controllers</code> in the back end to actually process the data, but that’s a topic for another day.</p>

<p>You can read more about Rails forms in the <a href="http://guides.rubyonrails.org/form_helpers.html">Rails Guides</a>.</p>


    
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    

    
    
      <li><strong class="current-page">1</strong></li>
    

    
    

    
    
    

    
      
        
        
        
        <li><a href="/page2/">2</a></li>
      
    

    
    

    
      <li><a href="/page3/">3</a></li>
    

    
    
      <li><a href="/page2/" class="btn">Next</a></li>
    
  </ul>
</div>

  
<div class="read-more">
  <div class="read-more-header">
    <a href="http://mitulmistry.github.io/" class="read-more-btn">About the Author</a>
  </div><!-- /.read-more-header -->
  <div class="read-more-content author-info">
    <h3>Mitul Mistry</h3>
    <div class="author-container">
      <img class="author-img" src="/images/avatar_mm.jpg" alt="Mitul Mistry" />
      <div class="author-bio">I’m Mitul Mistry, a full-stack developer and designer. Contact me here: MitulMistryDev@gmail.com</div>
    </div>
    <div class="author-share">
      <ul class="list-inline social-buttons">
        
          <li><a href="https://github.com/MitulMistry" target="_blank"><i class="fa fa-github fa-fw"></i></a></li>
        
          <li><a href="https://linkedin.com/in/mitulmistry" target="_blank"><i class="fa fa-linkedin fa-fw"></i></a></li>
        
      </ul>
      
        <a aria-label="Follow @MitulMistry on GitHub" data-style="mega" href="https://github.com/MitulMistry" class="github-button">Follow @MitulMistry</a>
      
      <br>
      
        <a href="https://twitter.com/mmystic" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @mmystic</a>
      
    </div>
  </div>
</div>


</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>



<!-- Asynchronous Google Analytics snippet -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6842596-6', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>





<script type="text/javascript">
    sharing();
</script>



<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Mitul Mistry</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
